<!-- templates/cad_hub/partials/_room_table.html - Bootstrap 5 -->
<div class="card">
    <div class="table-responsive">
        <table class="table table-hover mb-0">
            <thead class="table-light">
                <tr>
                    <th>Nr</th>
                    <th>Raumname</th>
                    <th>Geschoss</th>
                    <th class="text-end">Fläche</th>
                    <th class="text-end">Höhe</th>
                    <th>Nutzung</th>
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr style="cursor: pointer;"
                    hx-get="{% url 'ifc:room_detail' room.pk %}"
                    hx-target="#room-detail-panel"
                    hx-swap="innerHTML">
                    <td><code class="text-warning">{{ room.number }}</code></td>
                    <td><strong>{{ room.name }}</strong></td>
                    <td>{{ room.floor.name|default:"-" }}</td>
                    <td class="text-end font-monospace">{{ room.area|floatformat:1 }} m²</td>
                    <td class="text-end font-monospace">{{ room.height|floatformat:2 }} m</td>
                    <td>
                        {% if room.usage_category %}
                        <span class="badge bg-secondary">{{ room.get_usage_category_display }}</span>
                        {% else %}-{% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="6" class="text-center text-muted py-4">Keine Räume gefunden</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Pagination -->
{% if page_obj.has_other_pages %}
<nav class="mt-3">
    <ul class="pagination pagination-sm justify-content-center mb-0">
        {% if page_obj.has_previous %}
        <li class="page-item">
            <button class="page-link" hx-get="{% url 'ifc:room_list' ifc_model.id %}?page={{ page_obj.previous_page_number }}"
                    hx-target="#room-table-container" hx-include="[name='floor'], [name='usage']">←</button>
        </li>
        {% endif %}
        {% for num in page_obj.paginator.page_range %}
            {% if num == page_obj.number %}
            <li class="page-item active"><span class="page-link">{{ num }}</span></li>
            {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
            <li class="page-item">
                <button class="page-link" hx-get="{% url 'ifc:room_list' ifc_model.id %}?page={{ num }}"
                        hx-target="#room-table-container" hx-include="[name='floor'], [name='usage']">{{ num }}</button>
            </li>
            {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
        <li class="page-item">
            <button class="page-link" hx-get="{% url 'ifc:room_list' ifc_model.id %}?page={{ page_obj.next_page_number }}"
                    hx-target="#room-table-container" hx-include="[name='floor'], [name='usage']">→</button>
        </li>
        {% endif %}
    </ul>
</nav>
{% endif %}

<!-- Raum-Detail Panel (HTMX Target) -->
<div id="room-detail-panel" class="mt-3"></div>
